import { useState, useEffect } from "react";
import { checkBackend, scanUrls } from "./api";

function App() {
  const [urls, setUrls] = useState("");
  const [results, setResults] = useState([]);
  const [status, setStatus] = useState("checking");

  useEffect(() => {
    checkBackend().then(setStatus);
  }, []);

  const handleScan = async () => {
    try {
      const data = await scanUrls(urls.split("\n"));
      setResults(data.results || []);
    } catch {
      setStatus("down");
    }
  };

  return (
    <div>
      <h1>Latinotype Scanner</h1>
      <p>Estado del servidor: {status === "up" ? "ðŸŸ¢ Activo" : "ðŸ”´ CaÃ­do"}</p>

      <textarea
        value={urls}
        onChange={(e) => setUrls(e.target.value)}
        placeholder="Ingresa una o varias URLs"
      />

      <button onClick={handleScan}>ðŸš€ Escanear</button>

      <div>
        {results.map((r, i) => (
          <div key={i}>
            <strong>{r.url}</strong> â†’ {r.fuentesDetectadas.join(", ")} â†’{" "}
            {r.latinotype}
          </div>
        ))}
      </div>
    </div>
  );
}

export default App;
